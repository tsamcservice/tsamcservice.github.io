
<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<title>LIFF Card Share</title>
	<!-- flex2html -->
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/PamornT/flex2html@main/css/flex2html.css" />
	<script src="https://cdn.jsdelivr.net/gh/PamornT/flex2html@main/js/flex2html.min.js"></script>
	<!-- liff -->
	<script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
	<!-- 提示框 -->
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@10.16.5/dist/sweetalert2.min.css" />
	<script src="https://cdn.jsdelivr.net/npm/sweetalert2@10.16.5/dist/sweetalert2.min.js"></script>
	<!-- dom-to-image -->
	<script src="https://cdnjs.cloudflare.com/ajax/libs/dom-to-image/2.6.0/dom-to-image.min.js"></script>
	<!-- fontawesome -->
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" />
	<script src="https://use.fontawesome.com/releases/v5.0.0/js/all.js"></script>
	<!-- pickr 調色盤 -->
	<link rel="stylesheet" type="text/css"
		href="https://cdn.jsdelivr.net/npm/@simonwep/pickr@latest/dist/themes/nano.min.css">
	<script src="https://cdn.jsdelivr.net/npm/@simonwep/pickr@latest/dist/pickr.min.js"></script>

	<style>
		body {
			font-family: Arial, sans-serif;
		}

		.form-container {
			width: 310px;
			margin: 0 auto;
			padding: 20px;
			background-color: #f8f8f8;
			border-radius: 5px;
			box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
			overflow: hidden;
		}

		.form-group {
			margin-bottom: 15px;
		}

		label {
			position: relative;
			display: block;
			margin-bottom: 5px;
		}

		button {
			padding: 10px 20px;
			font-size: 16px;
			background-color: #009688;
			color: white;
			border: none;
			border-radius: 5px;
		}

		button:hover {
			background-color: #007c69;
		}

		.chatbox {
			background-color: transparent;
		}

		.hidden {
			display: none;
		}

		.loader {
			position: fixed;
			z-index: 9999;
			top: 0;
			left: 0;
			height: 100%;
			width: 100%;
			background: rgba(255, 255, 255, 0.8);
			display: none;
			justify-content: center;
			align-items: center;
		}

		.sk-chase {
			width: 70px;
			height: 70px;
			position: relative;
			animation: sk-chase 2.5s infinite linear both;
		}

		.sk-chase-dot {
			width: 100%;
			height: 100%;
			position: absolute;
			left: 0;
			top: 0;
			animation: sk-chase-dot 2.0s infinite ease-in-out both;
		}

		.sk-chase-dot:before {
			content: '';
			display: block;
			width: 25%;
			height: 25%;
			background-color: #009688;
			border-radius: 100%;
			animation: sk-chase-dot-before 2.0s infinite ease-in-out both;
		}

		.sk-chase-dot:nth-child(1) {
			animation-delay: -1.1s;
		}

		.sk-chase-dot:nth-child(2) {
			animation-delay: -1.0s;
		}

		.sk-chase-dot:nth-child(3) {
			animation-delay: -0.9s;
		}

		.sk-chase-dot:nth-child(4) {
			animation-delay: -0.8s;
		}

		.sk-chase-dot:nth-child(5) {
			animation-delay: -0.7s;
		}

		.sk-chase-dot:nth-child(6) {
			animation-delay: -0.6s;
		}

		.sk-chase-dot:nth-child(1):before {
			animation-delay: -1.1s;
		}

		.sk-chase-dot:nth-child(2):before {
			animation-delay: -1.0s;
		}

		.sk-chase-dot:nth-child(3):before {
			animation-delay: -0.9s;
		}

		.sk-chase-dot:nth-child(4):before {
			animation-delay: -0.8s;
		}

		.sk-chase-dot:nth-child(5):before {
			animation-delay: -0.7s;
		}

		.sk-chase-dot:nth-child(6):before {
			animation-delay: -0.6s;
		}

		@keyframes sk-chase {
			100% {
				transform: rotate(360deg);
			}
		}

		@keyframes sk-chase-dot {

			80%,
			100% {
				transform: rotate(360deg);
			}
		}

		@keyframes sk-chase-dot-before {
			50% {
				transform: scale(0.4);
			}

			100%,
			0% {
				transform: scale(1.0);
			}
		}

		#upload {
			position: absolute;
			left: 0;
			top: 0;
			opacity: 0;
		}

		#upload_btn {
			margin-right: 5px;
		}

		a {
			text-decoration: none;
		}

		.iconfont {
			font-family: "iconfont" !important;
			font-size: 16px;
			font-style: normal;
			-webkit-font-smoothing: antialiased;
			-moz-osx-font-smoothing: grayscale;
		}

		.links .iconfont {
			padding: 0 5px;
		}

		.links .iconfont:hover {
			background-color: transparent;
		}

		.links .iconfont {
			font-size: 2em;
		}

		.icon-facebook:before {
			content: "\e87f";
		}

		.icon-twitter:before {
			content: "\e88a";
		}

		.iconfont {
			color: #161209;
			text-decoration: none;
			transition: color 0.2s ease, border-color 0.2s ease, background 0.2s ease, opacity 0.2s ease;
			cursor: pointer;
		}

		.iconfont:hover {
			color: #2d96bd;
			text-decoration: none;
			transition: color 0.2s ease, border-color 0.2s ease, background 0.2s ease, opacity 0.2s ease;
		}

		@font-face {
			font-family: "iconfont";
			src:
				/* IE9 */
				url('iconfont.eot?t=1585328536727');
			src:
				/* IE6-IE8 */
				url('iconfont.eot?t=1585328536727#iefix') format('embedded-opentype'),
				url('data:application/x-font-woff2;charset=utf-8;base64,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') format('woff2'),
				url('iconfont.woff?t=1585328536727') format('woff'),
				/* chrome, firefox, opera, Safari, Android, iOS 4.2+ */
				url('iconfont.ttf?t=1585328536727') format('truetype'),
				/* iOS 4.1- */
				url('iconfont.svg?t=1585328536727#iconfont') format('svg');

		}

		@keyframes spin {
			0% {
				transform: rotate(0deg);
			}

			100% {
				transform: rotate(360deg);
			}
		}
	</style>
</head>

<body>
	<div class="loader" id="loader">
		<div class="sk-chase">
			<div class="sk-chase-dot"></div>
			<div class="sk-chase-dot"></div>
			<div class="sk-chase-dot"></div>
			<div class="sk-chase-dot"></div>
			<div class="sk-chase-dot"></div>
			<div class="sk-chase-dot"></div>
		</div>
	</div>

	<div class="hidden_forward">
		<div class="form-container">
			<div style="display: flex; justify-content: space-between; align-items: center; width: 310px">
				<h1 style="font-size:1.8em;">LIFF Card Share</h1>
				<button onclick="close_flex()" style="height: 40px">返回</button>
			</div>
			<div style="display: flex; justify-content: space-between; width: 310px">
				<div class="links">
					<a title="Share by Line" onclick="shareButton_line()">
						<i class="iconfont fab fa-line"></i>
					</a>
					<a title="Share by LinkedIn" id="shareButton_linkedin" onclick="shareButton_linkedin()" style="display: none">
						<i class="iconfont icon-linkedin"></i>
					</a>
					<a title="Share by FaceBook" target="_blank" rel="noopener" id="shareButton_facebook"
						onclick="shareButton_facebook()">
						<i class="iconfont icon-facebook"></i>
					</a>
					<a title="Share by Twitter" target="_blank" rel="noopener" id="shareButton_twitter"
						onclick="shareButton_twitter()">
						<i class="iconfont icon-twitter"></i>
					</a>
					<a title="Instagram" target="_blank" rel="noopener" href="https://www.instagram.com/wangzhengyan1219/"
						style="display: none">
						<i class="iconfont icon-instagram"></i>
					</a>
					<a title="Share by Mail" id="shareButton_mail" onclick="shareButton_mail()">
						<i class="iconfont far fa-envelope"></i>
					</a>
					<a title="Copy Link URL" onclick="shareButton_copyURL()">
						<i class="iconfont fas fa-share"></i>
					</a>
					<a title="Download Card" onclick="downloadButton()">
						<i class="iconfont fas fa-save"></i>
					</a>
				</div>
			</div>
			<div class="downloadFlex">
				<div style="width: 310px; height: auto; overflow: hidden;">
					<div class="chatbox">
						<div id="flex2html"></div>
					</div>
				</div>
			</div>
		</div>
	</div>

	<div class="hidden_backward">
		<div class="form-container">
			<div class="form-group">
				<button onclick="show_flex()">查看卡片</button>
			</div>
			<div class="form-group">
				<label>大圖 URL</label>
				<form>
					<label for="upload">
						<input type="button" id="upload_btn" value="點我上傳" />
						<input type="file" id="upload" accept="image/*" />
					</label>
					<span id="upload_text"></span>
				</form>
			</div>
			<div class="form-group">
				<label>點擊大圖 URL</label>
				<input id="textContent_2_url" style="width: 100%" type="text" placeholder="https://linecorp.com/" />
			</div>
			<div class="form-group">
				<label>主標1</label>
				<input id="mainTitle_1" style="width: 100%" type="text" placeholder="磊山 人文講堂" />
			</div>
			<div class="form-group">
				<label>名稱</label>
				<input id="subTitle_1" style="width: 100%" type="text" placeholder="余浩瑋" />
			</div>
			<div class="form-group">
				<label>別名</label>
				<input id="subTitle_2" style="width: 100%" type="text" placeholder="青藝盟盟主" />
			</div>
			<div class="form-group">
				<label>主標2</label>
				<input id="mainTitle_2" style="width: 100%" type="text" placeholder="《牽風箏的人》" />
			</div>
			<div class="form-group">
				<label>時間</label>
				<input id="textContent_1" style="width: 100%" type="text" placeholder="05/06(六)09:50~12:00" />
			</div>
			<div class="form-group">
				<label>地點</label>
				<input id="textContent_2" style="width: 100%" type="text" placeholder="磊山學院" />
			</div>
			<div class="form-group">
				<label>地址</label>
				<input id="textContent_3" style="width: 100%" type="text" placeholder="台北市南京東路二段178號10樓" />
			</div>
			<div class="form-group">
				<label>文字顏色</label>
				<div style="display: flex;  align-items: center; width: 310px; gap: 10px;">
					<div id="colorPicker"></div>
					<span id="textColor">#081F58FF</span>
				</div>
			</div>
			<!-- <div class="form-group">
            <label>文字內容3 URL</label>
            <input id="textContent_3_url" style="width: 100%;" type="text" placeholder="https://albert20699.github.io/">
        </div>
        <div class="form-group">
            <label>公司單位</label>
            <input id="companyUnit" style="width: 100%;" type=" text" placeholder="呈璽 Mtvs">
        </div>
        <div class="form-group">
            <label>分享卡片</label>
            <input id="share_card" style="width: 100%;" type="text" placeholder="分享卡片">
        </div>
        <div class="form-group">
            <label>收藏卡片</label>
            <input id="keep_card" style="width: 100%;" type="text" placeholder="收藏卡片">
        </div>
        <div class="form-group">
            <label>卡片描述</label>
            <input id="cardDescription" style="width: 100%;" type="text"
                placeholder="以上資料由【呈壐】整理自台北燈會官網，可點文字連結或下載詳細資料。歡迎加入【呈璽】官LINE@不再錯過精彩訊息喔~~">
        </div>
        <div class="form-group">
            <label>背景顏色</label>
            <input id="bgColor" style="width: 100%;" type="text" placeholder="#BA0101FF">
        </div> -->
		</div>
	</div>

	<script>
		var mainTitle_1, mainTitle_2, subTitle_1, subTitle_2, textContent_1, textContent_1_url, textContent_2, textContent_2_url, textContent_3, textContent_3_url, companyUnit, share_card, keep_card, cardDescription, bgColor, textColor, card_img_url;
		var flexJson, userId;

		function readShowCardData() {
			return JSON.stringify({
				mainTitle_1: document.getElementById("mainTitle_1").value || "",
				mainTitle_2: document.getElementById("mainTitle_2").value || "",
				subTitle_1: document.getElementById("subTitle_1").value || "",
				subTitle_2: document.getElementById("subTitle_2").value || "",
				textContent_1: document.getElementById("textContent_1").value || "",
				textContent_1_url: document.getElementById("upload_text").textContent || "",
				textContent_2: document.getElementById("textContent_2").value || "",
				textContent_2_url: document.getElementById("textContent_2_url").value || "",
				textContent_3: document.getElementById("textContent_3").value || "",
				textColor: document.getElementById("textColor").textContent || "",
				card_img_url: card_img_url,
				// textContent_3_url: document.getElementById("textContent_3_url").value || "",
				// companyUnit: document.getElementById("companyUnit").value || "",
				// share_card: document.getElementById("share_card").value || "",
				// keep_card: document.getElementById("keep_card").value || "",
				// cardDescription: document.getElementById("cardDescription").value || "",
				// bgColor: document.getElementById("bgColor").value || "",
			});
		}

		function writeShowCardData(data_card) {
			document.getElementById("mainTitle_1").value = data_card.mainTitle_1 || "";
			document.getElementById("mainTitle_2").value = data_card.mainTitle_2 || "";
			document.getElementById("subTitle_1").value = data_card.subTitle_1 || "";
			document.getElementById("subTitle_2").value = data_card.subTitle_2 || "";
			document.getElementById("textContent_1").value = data_card.textContent_1 || "";
			document.getElementById("upload_text").textContent = data_card.textContent_1_url || "";
			document.getElementById("textContent_2").value = data_card.textContent_2 || "";
			document.getElementById("textContent_2_url").value = data_card.textContent_2_url || "";
			document.getElementById("textContent_3").value = data_card.textContent_3 || "";
			// 設定textColor文字顏色
			document.getElementById("textColor").textContent = data_card.textColor || "#081F58";
			// 設定colorPicker調色盤顏色
			colorPicker.setColor(data_card.textColor || "#081F58")

			// document.getElementById("textContent_3_url").value = data_card.textContent_3_url || "";
			// document.getElementById("companyUnit").value = data_card.companyUnit || "";
			// document.getElementById("share_card").value = data_card.share_card || "";
			// document.getElementById("keep_card").value = data_card.keep_card || "";
			// document.getElementById("cardDescription").value = data_card.cardDescription || "";
			// document.getElementById("bgColor").value = data_card.bgColor || "";
		}

		function close_flex() {
			document.querySelector(".hidden_forward").classList.add("hidden");
			document.querySelector(".hidden_backward").classList.remove("hidden");
		}
		function show_flex() {
			document.querySelector(".hidden_forward").classList.remove("hidden");
			document.querySelector(".hidden_backward").classList.add("hidden");

			var mainTitle_1_Element = document.getElementById("mainTitle_1");
			mainTitle_1 = mainTitle_1_Element.value || mainTitle_1_Element.placeholder;

			var mainTitle_2_Element = document.getElementById("mainTitle_2");
			mainTitle_2 = mainTitle_2_Element.value || mainTitle_2_Element.placeholder;

			var subTitle_1_Element = document.getElementById("subTitle_1");
			subTitle_1 = subTitle_1_Element.value || subTitle_1_Element.placeholder;

			var subTitle_2_Element = document.getElementById("subTitle_2");
			subTitle_2 = subTitle_2_Element.value || subTitle_2_Element.placeholder;

			var textContent_1_Element = document.getElementById("textContent_1");
			textContent_1 = textContent_1_Element.value || textContent_1_Element.placeholder;

			var textContent_1_url_Element = document.getElementById("upload_text");
			textContent_1_url = textContent_1_url_Element.textContent || "https://i.ibb.co/B6KNp92/01-1-cafe.png";

			var textContent_2_Element = document.getElementById("textContent_2");
			textContent_2 = textContent_2_Element.value || textContent_2_Element.placeholder;

			var textContent_2_url_Element = document.getElementById("textContent_2_url");
			textContent_2_url = textContent_2_url_Element.value || textContent_2_url_Element.placeholder;

			var textContent_3_Element = document.getElementById("textContent_3");
			textContent_3 = textContent_3_Element.value || textContent_3_Element.placeholder;

			var textColor_Element = document.getElementById("textColor");
			textColor = textColor_Element.textContent;

			// var textContent_3_url_Element = document.getElementById("textContent_3_url");
			// textContent_3_url = textContent_3_url_Element.value || textContent_3_url_Element.placeholder;

			// var companyUnit_Element = document.getElementById("companyUnit");
			// companyUnit = companyUnit_Element.value || companyUnit_Element.placeholder;

			// var share_card_Element = document.getElementById("share_card");
			// share_card = share_card_Element.value || share_card_Element.placeholder;

			// var keep_card_Element = document.getElementById("keep_card");
			// keep_card = keep_card_Element.value || keep_card_Element.placeholder;

			// var cardDescription_Element = document.getElementById("cardDescription");
			// cardDescription = cardDescription_Element.value || cardDescription_Element.placeholder;

			// var bgColor_Element = document.getElementById("bgColor");
			// bgColor = bgColor_Element.value || bgColor_Element.placeholder;

			flexJson = {
				type: "flex",
				altText: "Flex Message",
				contents: {
					type: "carousel",
					contents: [
						{
							type: "bubble",
							hero: {
								type: "image",
								url: textContent_1_url,
								size: "full",
								aspectRatio: "1:1",
								aspectMode: "cover",
								action: {
									type: "uri",
									uri: textContent_2_url,
								},
							},
							body: {
								type: "box",
								layout: "vertical",
								position: "relative",
								height: "355px",
								contents: [
									{
										type: "box",
										layout: "vertical",
										backgroundColor: textColor,
										cornerRadius: "5px",
										contents: [
											{
												type: "text",
												text: "【" + mainTitle_1 + "】",
												weight: "bold",
												size: "xl",
												color: "#FFFFFFFF",
												align: "center",
												gravity: "center",
												contents: [],
											},
										],
									},
									{
										type: "box",
										layout: "horizontal",
										offsetTop: "5px",
										height: "45px",
										contents: [
											{
												type: "text",
												text: subTitle_1,
												weight: "bold",
												size: "xl",
												color: textColor,
												flex: 4,
												gravity: "center",
												contents: [],
											},
											{
												type: "text",
												text: subTitle_2,
												weight: "bold",
												color: textColor,
												flex: 8,
												gravity: "center",
												contents: [],
											},
										],
									},
									{
										type: "text",
										text: mainTitle_2,
										weight: "regular",
										color: textColor,
										contents: [],
									},
									{
										type: "text",
										text: "時間:" + textContent_1,
										weight: "regular",
										color: textColor,
										contents: [],
									},
									{
										type: "text",
										text: "地點:" + textContent_2,
										weight: "regular",
										color: textColor,
										contents: [],
									},
									{
										type: "text",
										text: "(" + textContent_3 + ")",
										weight: "regular",
										size: "sm",
										color: textColor,
										contents: [],
									},
									{
										type: "box",
										layout: "horizontal",
										position: "absolute",
										offsetTop: "200px",
										offsetStart: "10px",
										width: "320px",
										contents: [
											{
												type: "box",
												layout: "vertical",
												paddingTop: "10px",
												width: "135px",
												height: "40px",
												backgroundColor: "#B5B8BDFF",
												contents: [
													{
														type: "text",
														text: "分享給好友",
														color: "#FFFFFFFF",
														align: "center",
														action: {
															type: "uri",
															uri: "https://liff.line.me/1660908511-Ol7grGPY/?userId=" + encodeURIComponent(userId),
														},
														contents: [],
													},
												],
											},
											{
												type: "box",
												layout: "vertical",
												offsetStart: "10px",
												paddingTop: "10px",
												width: "135px",
												height: "40px",
												backgroundColor: "#B5B8BDFF",
												contents: [
													{
														type: "text",
														text: "收藏資訊",
														color: "#FFFFFFFF",
														align: "center",
														contents: [],
													},
												],
											},
										],
									},
									{
										type: "box",
										layout: "vertical",
										action: {
											type: "uri",
											// "uri": "https://3428750.so-buy.com/"
											uri: "https://calendar.google.com/calendar/u/0/r/eventedit?pli=1&uid=62890calndrlink&sf=1&output=xml&dates=20230603T095000/20230603T120000&ctz=Asia/Taipei&text=【磊山+人文講堂】&details=【公益可以不一樣+成為改變的起點】",
										},
										position: "absolute",
										offsetTop: "250px",
										offsetStart: "10px",
										paddingTop: "10px",
										width: "280px",
										height: "40px",
										backgroundColor: "#91AFC2FF",
										contents: [
											{
												type: "text",
												text: "設定提醒(google行事曆)",
												color: "#FFFFFFFF",
												align: "center",
												contents: [],
											},
										],
									},
									{
										type: "box",
										layout: "vertical",
										action: {
											type: "uri",
											uri: "https://3428750.so-buy.com/",
										},
										position: "absolute",
										offsetTop: "300px",
										offsetStart: "10px",
										paddingTop: "10px",
										width: "280px",
										height: "40px",
										backgroundColor: "#91AFC2FF",
										contents: [
											{
												type: "text",
												text: "製作美美的卡片✨",
												color: "#FFFFFFFF",
												align: "center",
												contents: [],
											},
										],
									},
								],
							},
						},
					],
				},
			};

			// 將flexJson繪出到HTML上
			my_flexToHtml();
		}

		function my_flexToHtml() {
			document.getElementById("flex2html").innerHTML = "";
			flex2html("flex2html", flexJson);

			// 將錯誤的 ExXxs 替換為正確的 ExXXs
			var wrongExXxsElements = document.querySelectorAll(".ExXxs");
			wrongExXxsElements.forEach(function (element) {
				element.classList.remove("ExXxs");
				element.classList.add("ExXXs");
			});

			// 將錯誤的 Ex3xl 替換為正確的 Ex3Xl
			var wrongEx3xlElements = document.querySelectorAll(".Ex3xl");
			wrongEx3xlElements.forEach(function (element) {
				element.classList.remove("Ex3xl");
				element.classList.add("Ex3Xl");
			});

			// 將 LySlider 關閉下方捲動軸
			var wrongLySliderElements = document.querySelector(".LySlider");
			wrongLySliderElements.style.webkitOverflowScrolling = "auto";
			wrongLySliderElements.style.overflowX = "visible";

			// 將 chatbox 上方空白縮短
			var wrongchatboxElements = document.querySelector(".chatbox");
			wrongchatboxElements.style.paddingTop = "20px";
		}

		async function sendRequest(status, userId, data_card = "") {
			if (!status || !userId) {
				return;
			}

			const url = "https://script.google.com/macros/s/AKfycbzmKJEzFnkDj6APsRhPwV1c9qj51sQvgylxLAij0n4kDwyHxcHRUWwgFu8iq-ah8sGL2w/exec";

			try {
				const data = { status: status, userId: userId, card: data_card };

				// 將資料轉換成查詢字串
				const queryString = new URLSearchParams(data).toString();

				const response = await fetch(`${url}?${queryString}`);
				const responseData = await response.json();

				console.log("Data sent:", data);
				console.log("Response:", responseData);
				return responseData;
			} catch (error) {
				console.error("Error sending data:", error);
			}
		}

		// colorPicker創建調色盤元素(文字放textColor)
		var textColor_Element = document.getElementById("textColor");
		const colorPicker = Pickr.create({
			el: '#colorPicker',
			theme: 'nano', // 使用 NANO 主題
			default: "#081F58", // 預設顏色
			components: {
				preview: true,
				opacity: true,
				hue: true,
				interaction: {
					input: true,
				}
			}
		});
		// colorPicker顏色更改事件
		colorPicker.on('change', (color) => {
			textColor_Element.textContent = color.toHEXA().toString();
		});
		// colorPicker失去焦點事件
		colorPicker.on('hide', () => {
			colorPicker.applyColor(); // 應用顏色到目標元素
			// 卡片資料存到google sheet
			sendRequest("save", userId, readShowCardData());
		});

		window.onload = function () {
			document.querySelector(".hidden_forward").classList.add("hidden");
			document.getElementById('loader').style.display = 'flex';
			liff.init({ liffId: "1660908511-DERZWN3m" })
				.then(() => {
					if (!liff.isLoggedIn()) {
						liff.login();
					}
					else {
						liff.getProfile()
							.then(async function (profile) {
								userId = profile.userId
								var responseData = await sendRequest("get", userId)
								if (responseData.status === 'ok') {
									const data_card = JSON.parse(responseData.card);
									writeShowCardData(data_card)
									console.log(data_card);
								}
								document.getElementById('loader').style.display = 'none';
							})
							.catch(function (error) {
								alert("取得使用者資料錯誤\n", error);
							});
					}
				});
		};

		// 分享line按钮的點擊事件
		function shareButton_line() {
			liff
				.shareTargetPicker([flexJson])
				.then(function (res) {
					if (res) {
						// 送出提醒框
						Swal.fire({
							text: "卡片已送出",
							timer: 800,
							showConfirmButton: false,
							customClass: {
								container: "swal-container",
								popup: "swal-popup",
								content: "swal-content",
							},
						});
					} else {
						const [majorVer, minorVer] = (liff.getLineVersion() || "").split(".");
						if (parseInt(majorVer) < 10 || (parseInt(majorVer) == 10 && parseInt(minorVer) < 11)) {
							alert("沒有 TargetPicker 功能\n請嘗試更新 LINE");
						} else {
							alert("有 TargetPicker 功能，但發送訊息未成功");
						}
					}
				})
				.catch(function (err) {
					alert("分享傳送訊息失敗\n請檢查URL及內容\n", err);
				});
		}

		// 分享mail按钮的點擊事件
		function shareButton_mail() {
			document.getElementById("shareButton_mail").href = "mailto:?subject=【卡片分享】&body=使用瀏覽器預覽照片連結：https://albert20699.github.io/preview/?userId=" + encodeURIComponent(userId);
			// document.getElementById("shareButton_mail").href = "mailto:?subject=【卡片分享】-&body=請參考圖片附件:[圖片](https://i.ibb.co/8YTW70m/blob.jpg)&attachment=https://i.ibb.co/8YTW70m/blob.jpg";
		}
		// 分享twitter按钮的點擊事件
		function shareButton_twitter() {
			// 截圖卡片後資料存入google sheet
			var card = document.querySelector(".downloadFlex");
			domtoimage.toBlob(card).then(function (blob) {
				card_img_url = uploadImg(blob)
				alert(card_img_url);
			})
			sendRequest("save", userId, readShowCardData());
			document.getElementById("shareButton_twitter").href = "https://twitter.com/intent/tweet?url=https://albert20699.github.io/preview/?userId=" + encodeURIComponent(userId);
		}
		// 分享facebook按钮的點擊事件
		function shareButton_facebook() {
			// 截圖卡片後資料存入google sheet
			var card = document.querySelector(".downloadFlex");
			domtoimage.toBlob(card).then(function (blob) {
				card_img_url = uploadImg(blob)
				alert(card_img_url);
			})
			sendRequest("save", userId, readShowCardData());
			document.getElementById("shareButton_facebook").href = "https://www.facebook.com/sharer/sharer.php?u=https://albert20699.github.io/preview/?userId=" + encodeURIComponent(userId);
		}

		// 分享Copy Link URL按钮的點擊事件
		async function shareButton_copyURL() {
			// 取得要複製的文字
			var textToCopy = "https://albert20699.github.io/preview/?userId=" + encodeURIComponent(userId)

			try {
				await navigator.clipboard.writeText(textToCopy);
			} catch (err) {
				try {
					// 建立一個臨時的 textarea 元素
					var tempTextarea = document.createElement("textarea");
					tempTextarea.value = textToCopy;

					// 將 textarea 加入到文件中
					document.body.appendChild(tempTextarea);

					// 選取並複製文字
					tempTextarea.select();
					document.execCommand("copy");

					// 移除臨時的 textarea 元素
					tempTextarea.remove();
				} catch (err) {
					alert("無法複製文字")
					return;
				}
			}

			// 送出提醒框
			Swal.fire({
				text: "文字已複製到剪貼簿",
				timer: 800,
				showConfirmButton: false
			});
		}

		// 截圖按钮的點擊事件
		function downloadButton() {
			// 獲取瀏覽器的使用者代理
			var userAgent = navigator.userAgent;
			// 檢查是否執行於line
			var isOnLine = /line/i.test(userAgent)

			if (isOnLine) {
				// 由於line本身無法下載檔案，一律跳轉用外部瀏覽器下載
				alert("將自動開啟預設瀏覽器\n並下載檔案")
				liff.openWindow({
					url: 'https://albert20699.github.io/download_card/?userId=' + encodeURIComponent(userId),
					external: true  // 開啟外部瀏覽器
				});
			}
			else {
				// 取得下載框的元素
				var card = document.querySelector(".downloadFlex");

				// 使用dom-to-image庫進行截圖
				domtoimage.toBlob(card).then(function (blob) {
					// 創建下載連結
					var link = document.createElement("a");
					link.href = URL.createObjectURL(blob);
					// 獲取當前時間戳
					var timestamp = Date.now();
					link.download = mainTitle_1 + "_" + timestamp + ".png";

					// 觸發下載
					link.click();

					// 清理URL對象，釋放資源
					URL.revokeObjectURL(link.href);
				})
					.catch(function (error) {
						alert("下載錯誤\n", error);
					});
			}
		}

		function test() {
			const accessToken = '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';
			const owner = 'albert20699';
			const repo = 'albert20699.github.io';
			const filePath = 'og_html/13.html';
			const fileContent =
				`<!DOCTYPE html>
					<html lang="en">
					<head>
						<meta charset="UTF-8">
						<meta name="viewport" ontent="width=device-width, initial-scale=1.0">
						<meta property="og:image" content="https://i.ibb.co/tP1v2SV/blob.jpg">
						<meta property="og:title" content="">
						<meta property="og:description" content="">
						<meta property="og:url" content="">
						<meta property="og:site_name" content="My Website">
					</head>
					<body>
					</body>
					</html>`;


			function uploadFileToGitHub() {
				try {
					const url = `https://api.github.com/repos/${owner}/${repo}/contents/${filePath}`;
					const headers = {
						Authorization: `Bearer ${accessToken}`,
						'Content-Type': 'application/json',
					};
					const payload = {
						message: 'html for OG',
						content: btoa(fileContent),
					};

					const options = {
						method: 'PUT',
						headers: headers,
						body: JSON.stringify(payload),
					};

					fetch(url, options)
						.then(response => response.json())
						.then(responseData => {
							console.log(responseData); // 请求成功后的响应数据
						})
						.catch(error => {
							console.log(error); // 请求发生错误时的处理
						});
				} catch (error) {
					console.log(error);
				}
			}

			uploadFileToGitHub();
		}


		// 檢查是否有新圖片更新到網頁並上傳
		document.getElementById("upload").addEventListener("change", async function (event) {
			document.getElementById("loader").style.display = "flex";
			var file = event.target.files[0]; // 取得選擇的檔案
			textContent_1_url = await uploadImg(file); // 上傳檔案並回傳URL
			document.getElementById("upload_text").textContent = textContent_1_url;
			sendRequest("save", userId, readShowCardData());
			document.getElementById("loader").style.display = "none";
		});

		// 上傳檔案並回傳URL
		function uploadImg(file) {
			return new Promise((resolve, reject) => {
				var reader = new FileReader();
				reader.onload = function () {
					var fileBlob = dataURLtoBlob(reader.result);
					var formData = new FormData();
					formData.append("image", fileBlob);

					fetch("https://api.imgbb.com/1/upload?key=9370c80a93b313d5f526531503162623&expiration=15552000", {
						method: "POST",
						body: formData,
					})
						.then(function (response) {
							return response.json();
						})
						.then(function (data) {
							resolve(data.data.display_url);
						})
						.catch(function (error) {
							alert("上傳照片錯誤\n", error);
							reject(error);
						});
				};
				reader.readAsDataURL(file);
			});
		}
		function dataURLtoBlob(dataURL) {
			var arr = dataURL.split(","); // 將資料URL分割成類型和資料部分
			var mime = arr[0].match(/:(.*?);/)[1]; // 提取資料URL中的MIME類型
			var bstr = atob(arr[1]); // 解碼Base64編碼的資料部分
			var n = bstr.length;
			var u8arr = new Uint8Array(n);
			while (n--) {
				u8arr[n] = bstr.charCodeAt(n); // 轉換為Uint8Array
			}
			return new Blob([u8arr], { type: mime }); // 創建Blob物件
		}

		// 元素失去焦點事件
		document.addEventListener("blur", function (event) {
			// 檢查事件源是否為輸入框且已經loading完成
			if (event.target.tagName.toLowerCase() === "input" && document.getElementById("loader").style.display == "none") {
				// 檢查textContent_2_url的input格是否合法的url
				if (event.target.id === "textContent_2_url" && event.target.value != "") {
					try {
						new URL(event.target.value);
					} catch (error) {
						alert("URL格式錯誤")
						event.target.value = ""
						return;
					}
				}
				// 卡片資料存到google sheet
				sendRequest("save", userId, readShowCardData());
			}
		}, true); // 注意，這裡的 true 參數是為了在捕獲階段觸發事件，這對於 'blur' 和 'focus' 事件是必要的。
	</script>
</body>

</html>